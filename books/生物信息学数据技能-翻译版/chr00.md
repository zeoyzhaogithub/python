# 绪论

&emsp;&emsp;在两年前对我自己提出的这个问题的回答。当我开始在这个领域工作时，我只有python和r方面的编程经验，其他方面的经验很少。我四处寻找关于生物信息学的极好的入门教材，虽然我找到了一些好书，但大多数都不是针对我作为生物信息学家的日常工作所需要的。我找到的一些文本从理论和算法的角度探讨了生物信息学，包括Smith-Waterman比对、系统发育重建、motif查找等主题。尽管它们很吸引人去阅读(并且我确实建议您多阅读这些材料)，但我没有必要在我的日常生物信息学工作中从头开始实现生物信息学算法——这些算法已经存在大量出色的、高度优化的、经过良好测试的实现。其他生物信息学文本采取了更为明确的方法，指导不熟悉计算的读者完成每一步任务，比如运行对齐器或从数据集中下载序列。虽然这些更适用于我的工作，但是，相对而言，他们的书中的大部分内容是过时的。

&emsp;&emsp;正如你所猜到的那样，我找不到比这版的《生物信息学数据技能》更好的生物信息学书了。这本书面向那些不确定如何弥合脚本语言和实践生物信息学之间的巨大差距以便以一个健壮的和可复用的方式回答科学问题的读者。要弥合这一差距，必须学习数据技能 - 这种方法使用一套核心工具来操纵和探索您在生物信息学项目中遇到的任何数据。

&emsp;&emsp;数据技能是学习生物信息学的最佳方法，因为这些技能使用经过时间检验的开放源码工具，这些工具仍然是操作和探索不断变化的数据的最佳方法。这种方法经受住了时间的考验:高通量测序的出现迅速改变了生物信息学领域，但熟练的生物信息学使用这些相同的工具和技能来适应了这一新数据。毕竟，下一代数据只是数据（差异数据，以及更多数据），而生物信息学大师拥有通过将他们的工具应用于这些新数据来解决问题的基本技能。编写《生物信息学数据技能》是为了帮您学习这些核心工具，帮助您发展相同的技能。

## 使用这本书的方法
&emsp;&emsp;许多生物学家从生物信息学起步，往往把“学习生物信息学”等同于“学习如何运行生物信息学软件”。
## 为什么这本书关注测序数据

&emsp;&emsp;生物信息学是一门广泛的学科，涵盖蛋白质组学，代谢组学，结构生物信息学，比较基因学，机器学习和图像处理等子领域。本书主要关注处理测序数据，原因有几个。

&emsp;&emsp;首先，测序数据资源丰富。目前，没有其他“组学”能像测序数据一样有高通量且丰富的数据。测序数据在生物学中具有广泛的应用：变异检测和基因分类，用于基因表达研究的转录组测序，蛋白质-DNA相互作用测定如ChIP-seq，以及用于亚硫酸氢盐甲基化研究的测序等几个例子。这种用测序数据来回答生物学问题的方式只会越来越多。

&emsp;&emsp;其次，测序数据非常适合磨炼你的数据技能。即使，在将来你准备分析其他类型的数据，测序数据依然是学习的最佳示例数据。开发使用测序数据所必需的文本处理技能将适用于处理许多其他数据类型。

&emsp;&emsp;然后，生物信息学的其他子领域更具特定领域。测序的广泛可用性和不断下降的成本使得所有学科的科学家能够使用基因组学数据来回答他们系统中的问题。相比之下，像蛋白质组学或高通量图像处理这样的生物信息学子学科更加专业化，而且不那么广泛。但是，如果您对这些领域感兴趣，本书将教您有用的计算和数据技能，这将有助于您的研究。

## 观众

&emsp;&emsp;根据我在加州大学戴维斯分校为我的朋友、同事和学生进行为期一周的密集课程生物信息学的教学经验，大多数希望学习生物信息学的人都是生物学家或计算机科学家/程序员。生物学家希望教授他们分析自己的数据所必需的计算技能，而程序员和计算机科学家希望教他们如何利用计算技能去解决生物学问题。尽管这两组在生物学知识和计算经验方面存在很大差异，但是《生物信息学数据技能》这本书覆盖的内容对于这两组的诉求都能给与帮助。

&emsp;&emsp;如果你是生物信息学家，《生物信息学数据技能》这本书将会教你在工作中需要的处理生物信息数据的核心技能。值得注意的是，这本书不是一本告诉你什么是生物信息学的书籍;这本关于生物信息学的书很快就会出现数据，或者过于专注于数据以至于无法帮助大多数生物学家。您需要根据您的特定研究方向和系统需求，以及您的子领域使用的现代统计和生物信息学方法，补充本书没有的内容。例如，如果您的项目涉及将测序读数与参考基因组对齐，本书将不会告诉您最新且最佳的校准软件适用于您的特定系统。但无论您使用哪种校准器，您都需要了解校准格式和如何操纵对齐数据 - 这些内容在第11章中有相关介绍。

&emsp;&emsp;在本书中，这些一般的计算和数据技能是大多数生物学家可以构建的坚实，广泛适用的基础。如果你是一个计算机科学家或者程序员，我在这本书中讲到的算法工具你肯定很熟悉。虽然本书中介绍的内容可能与您已有的知识重叠，但您仍将了解生物信息学家在工作中使用的具体格式，工具和方法。同时，通过本书中的示例，您将获得应用基因组学数据的计算技巧。

## 不同级别的数据技能

&emsp;&emsp;这本书旨在成为一本紧密相宜的书。当我开始写这本书的时候，我决定我能做的最坏的打算就是把生物信息学当做一门比实际情况更容易的学科。作为一个专业的生物信息学家，我经常看到一些非常微妙的问题会突然出现，如果他们没有被发现，就会对分析结果产生不利的影响。我不希望你的生物信息学工作是不正确的，因为我人为地简化了一个主题。在《生物信息学数据技能》中的主题涉及的内容比较难，如果你能很好的理解这些内容，你在自己的工作中发现了类似的问题时，能够很好的利用这些知识解决问题。

&emsp;&emsp;这本书的章节内容比较超前，对于部分读者来说可能比较难。不要气馁！像大多数学科一样，这种学科很难，所以，可能需要多读几次才能完全理解。在整本书中，我试图表明。当某些部分特别难时，您可以跳过这些部分之后返回到这些部分进行学习。

&emsp;&emsp;最后，我经常在整本书中使用技术术语。我不喜欢使用技术术语，但在计算机领域，必须使用技术概念进行交流。而且，这种技术术语，可以帮助您可以搜索其他资源和帮助。例如，在google上搜索“左外部连接”比“在一个表中包含空记录的数据合并”要更容易得想要的结果。

## 学习前提

&emsp;&emsp;《生物信息学数据技能》是一本关于生物信息学的中间书籍。为了确保每个人都从同一个节奏开始，这本书从几个简单的章节开始。在第二章中设置了一些基础的生物信息学小项目，在第3章中，我将教授一些关于Unix基础内容，这些内容旨在确保您对Unix有一个基本的理解(因为在后面的章节中，Unix是一个很大章节去讲)。不过，作为一本中间的书，我对你做了一些假设：

*你会一门脚本语言*

&emsp;&emsp;这是使用这本书的前提。除了几个Python程序和R相关的内容(R在第8章中介绍)，这本书并不直接依赖于使用大量脚本。但是，在学习脚本语言时，您已经遇到了许多重要的计算概念，例如使用文本编辑器、在命令行上运行和执行程序以及基础的编程技能。如果你不会任何脚本语言，我建议你在学习这本书的同时学习python。例如《使用Python进行生物信息学编程》(Mitchell L. Model O‘Reilly，2009年)，《学习Python》，第5版(Mark Lutz O‘Reilly，2013年)，和 Python in a Nutshell，第二版(Alex Martelli O‘Reilly，2006)都是很好的开始学习Python的书。如果您知道除Python外的其他脚本语言(例如Perl或Ruby)，您将准备好跟随大多数示例(尽管您需要将一些示例转换成您熟悉的脚本语言)。

*你会使用文本编辑器*

&emsp;&emsp;了解文本编辑器(例如Emacs、Vim、Text-Mate2或SublimText)是很重要的。使用字处理器(例如Microsoft Word)将不起作用，我不鼓励使用记事本或OS X的Tex-tEdit等文本编辑器，因为它们缺乏对常见编程语言的语法突出显示的支持。

*你会Unix命令行*

&emsp;&emsp;例如，我假设您知道终端和shell之间的区别，了解如何输入命令,哪些命令行有什么选项，标志和参数，以及如何使用向上箭头检索最后输入的命令。您还应该对unix文件层次结构有一个基本的了解(包括主目录、相对目录与绝对目录以及根目录等概念)。您还应该能够使用cd、ls、pwd、mv、rm、rmdir和mkdir等命令在Unix中移动和操作目录和文件。最后，您应该掌握基本的Unix文件的所有权和权限，并使用chown和chmod更改它们。如果这些概念不清楚，我建议您小心使用unix命令行，并参考一本好的初学者级别的书，如《生物学家实用计算》( Steven Haddock and Casey Dunn Sinauer，2010年)或《UNIX和Perl基础》（UNIX and Perl to the Rescue）(Keith Bradnam and Ian Korf  剑桥大学出版社，2012年)。

*你对生物学有基本的了解。*

&emsp;&emsp;《生物信息学数据技能》需要你自己了解生物学的基础知识。除了DNA、RNA、蛋白质和基因之外，这些例子并不需要太多的生物学背景，也不需要分子生物学的核心内容。您还应该熟悉一些非常基本的遗传学和基因组概念(例如，单核苷酸多态性、基因型、GC内容等)。这本书中的所有生物学示例都设计得非常简单；如果您不熟悉某个专业名词，您应该能够快速浏览一篇Wikipedia相关的文章并继续该示例。

*您对正则表达式有基本的了解。*

&emsp;&emsp;偶尔，我会再这本书中使用正则表达式。大部分情况下，我将尝试使用最基本的正则表达式，以便您了解基本概念。如果您在学习脚本语言时遇到过正则表达式，那么就可以开始学习了。如果没有，我建议您学习基础的正则表达式知识-不是因为整本书中大量使用正则表达式，而是因为掌握正则表达式是生物信息学中的一项重要技能。《正则表达式介绍》作者迈克尔·菲茨杰拉德(Introducing Regular Expressions by Michael Fitzgerald O‘Reilly)是一本很好的书。现在，编写、测试和调试正则表达式比以往任何时候都更容易，这要归功于一些在线工具，如[https://jex.im/regulex/](https://jex.im/regulex/)、[http://regex101.com](http://regex101.com)和[http://www.debuggex.com](http://www.debuggex.com)我建议在您自己的工作中,使用这本书中的正则表达式示例时使用这些工具。

*你知道如何查找帮助并能看懂文档*

&emsp;&emsp;在这本书中，我尽量减少可以在手册、帮助文档或在线资源中找到的教学信息。有三个原因：

1. 我想节省空间，专注于以展示你在其他地方找不到的资料和内容。
2. 手册页和文档将永远是这方面信息的最佳资源。
3. 在文档中快速找到答案是你学习计算机最重要的技能之一。

&emsp;&emsp;最后这一点特别重要；您不需要记住所有命令或R函数的所有参数-您只需要知道在哪里可以找到这些信息。程序员在工作中经常参考文档，这就是为什么在文档存在诸如man(在Unix中)和help()(在R中)工具的原因。

*您可以管理你的计算机系统(或拥有系统管理员权限)*

&emsp;&emsp;本书并没有教您系统管理技巧，如设置生物信息学服务器或集群、管理用户帐户、网络安全、管理磁盘和磁盘空间、RAID配置、数据备份和高性能计算概念。根本没有足够的空间来充分讨论这些重要的话题。然而，这些都是非常，非常重要的，如果您没有系统管理员，并且需要为您的实验室或研究团队填补该职位，则您也必须掌握这些技能。坦率地说，系统管理技能需要几年的时间才能掌握，而优秀的系统管理员在处理问题时具有令人难以置信的耐心和经验，这些问题会使大多数科学家发疯。如果您可以使用在实验室或组之间共享的全职系统管理员，或者使用带有系统管理员的大学群集，我就是这样做的。最后，这不是必须的，只是以防万一：不断备份你的数据和工作结果。当学习Unix来执行一个破坏文件的命令是很容易的-你最好的防止丢失所有东西的方法就是连续备份。

## github上的补充资料

&emsp;&emsp;这本书中的例子和其他资料可以在[github](https://github.com/vsbuffalo/bds-files)上获取。您可以根据需要从git库下载相应内容(git上的内容按章分类)，或者，您可以通过链接下载Zip文件包。一旦您在第5章中学习了Git，我将建议您克隆存储库，以便在意外重写任何示例文件时都可以恢复它们。等到在第5章中学习了Git，我将建议您克隆存储库，以便在意外重写任何示例文件时都可以恢复它们。现在尝试导航到这个存储库并浏览相应内容，以便熟悉正本书的布局。查看前言的目录，您会发现README.md文件，其中包含关于我所讨论的许多主题的其他信息。除了本书中所有示例所需的补充文件外，此存储库还包含：
1. 关于所有补充文件是如何制作或如何获得的文件。在某些情况下，我通过创建文件或脚本(这两个主题都包含在第12章中)来创建示例数据，所有这些资源都可以在每章的GitHub目录中找到。包括了这些材料，不仅是为了可以重复使用，而且也是作为额外的学习材料。
2. 读者可能会对每一章都感兴趣。这些信息在每章的README.md文件中有列出。我还包括了其他资源，如推荐以供进一步学习的书籍列表，。
3. 纠错，以及任何必要的更新(如料由于某种原因而过时)。

&emsp;&emsp;我选择在GitHub上托管《生物信息学数据技能》的补充文件，这样我可以随时更新所有内容，并解决读者可能遇到的任何问题。如果您发现这本书或它的补充材料有任何问题，请随时在GitHub上创建一个新的问题。

## 计算资源和设置

&emsp;&emsp;我是在一台15英寸16 GB的RAM的MacBookPro笔记本电脑上完成整本书的写作。尽管这是一台功能强大的笔记本电脑，但它比生物信息学计算中常见的服务器要小得多。所有的例子都被设计和测试来运行一台这么大的机器。几乎每个示例都应该在具有8 GB内存的计算机上运行。

&emsp;&emsp;本书中的所有示例都不支持MacOSX和Linux以外的其他操作系统(主要是因为现代生物信息学依赖于基于Unix的操作系统)。本书中所需的所有软件都是免费提供的，并且易于安装；因为需要安装软件，所以我在每一节中都提供了一些基本的说明。通常，您应该使用操作系统的包管理系统(例如，在Ubuntu/Debian上的APT-GET)。如果您使用的是Mac，我强烈推荐Homebrew，这是一个非常棒的OSX软件包管理器，您可以使用它用命令行轻松地安装软件。你可以在Homebrew的官网上找到详细的说明，最重要的是Homebrew维护一组名为“Homebrew-Science”的科学软件包，包括我们在本书中使用的生物信息学软件。按照Homebrew-Science‘s的Readme.md文件中的说明学习如何安装这些科学程序。

## 本书的构成

&emsp;&emsp;这本书由三部分构成：第一部分，包含一个关于意识形态的章节；第二部分，包括生物信息学项目入门的基础知识；第三部分，涉及生物信息学数据技能。虽然章节是按顺序编写的，但如果您熟悉Unix和R，您可能会发现您可以跳过这些章节而不会遇到任何问题。

&emsp;&emsp;在第一章中，我介绍了为什么通过发展数据技能来学习生物信息学是最好的方法。我还介绍了这本书的思想，并描述了可再生和强大的生物信息学和一些建议，以适用于您自己的工作。

&emsp;&emsp;《生物信息学数据技能》第二部分介绍了启动生物信息学项目所需的基本技能。首先，我们将在第2章中研究如何设置和管理项目目录。这可能看起来是个琐碎的话题，但复杂的生物信息学项目需要我们考虑项目管理。在大型的研究中，到处都是文件。从一个精心组织的项目开始，可以避免许多不必要的麻烦。我们还将学习一种非常有用的纯文本项目文档格式Markdown文档。

&emsp;&emsp;在第三章中，为了确保您对基本概念(例如，管道、重定向、标准输入和输出等)有扎实的理解，我们将会讲解生物信息学中的UNIX。了解这些必备的基础知识将使您能够在后面的章节中专注于分析数据，而不是费尽周折地理解Unix的基础知识。

&emsp;&emsp;大多数生物信息学任务需要更强的计算能力，这意味着我们必须使用远程服务器和集群。第4章介绍了在使用远程机器时提高工作效率的一些方法和技巧。

&emsp;&emsp;在第五章中我们将学习一个简化项目版本管理的版本控制系统-git。生物信息学项目充满了大量的代码和数据，这些代码和数据应该使用与协作开发的软件相同的现代工具进行管理。Git是一款功能强大的大型软件，因此这是一个很长的章节。但是，编写本章是为了使您可以跳过关于分支的一节，稍后再返回到它。

&emsp;&emsp;第6章研究生物信息学项目中的数据：如何下载大量数据、如何使用数据压缩、验证数据完整性以及如何可重复地下载项目数据。

&emsp;&emsp;在第三部分中，我们的注意力转向发展所有生物信息工作者在日常工作中解决问题所需的基本数据技能。第7章重点介绍Unix数据工具，这些工具允许您快速编写强大的流处理Unix管道来处理生物信息学数据。这种方法是现代生物信息学的基石，是一项绝对必要的数据技能。

&emsp;&emsp;在第八章中，我通过学习探索性数据分析技术来介绍R语言。本章让您使用R来使用可视化和数据汇总等技术来探索您自己的数据。

&emsp;&emsp;基因组范围数据在生物信息学中是无处不在的，因此我们将在第9章中讨论范围数据和范围操作。我们将首先通过不同的方法来表示基因组范围，并通过使用BioConductor的IRrangesPackage包进行范围操作来增强我们的范围思维直觉。然后，我们将使用GenomicRange处理基因组数据。最后，我们将研究用于在命令行上处理范围数据的BED工具包。

&emsp;&emsp;在第10章中，我们学习了序列数据，它是生物信息学数据的支柱。我们将研究Fasta和FASTQ格式(以及它们的局限性)，并通过从序列中修剪低质量的基组，看看这是如何影响质量分数的分布的。我们还将研究Fasta和FASTQ的解析。

&emsp;&emsp;第11章重点介绍了对准数据格式SAM和BAM。理解和操作这些格式的文件是处理高通量测序数据的一项不可或缺的生物信息学技能。我们将学习如何使用Samtools操作这些文件并对这些数据进行可视化处理，通过一个详细的示例来说明变量调用的一些复杂性。最后，我们将学习如何使用Pysam来解析SAM/BAM文件，以便您可以编写自己的脚本来处理这些特定数据格式的文件。

&emsp;&emsp;大多数生物信息学的日常工作都涉及到编写数据处理脚本和管道。在第12章中，我们将介绍如何编写健壮的和可复用的数据处理管道。我们将专门研究Bash脚本，使用Unix强大工具(如find和xargs)处理文件，最后快速了解如何使用make和makefile编写管道。

&emsp;&emsp;在生物信息学中，我们的数据常常太大，无法放入我们的计算机内存中。在第7章中，我们了解了如何使用Unix管道流处理来帮助解决这个问题，但是第13章介绍了一种不同的方法：不适用内存的方法。首先，我们将研究Tabix，这是一种快速访问索引制表符分隔文件中的信息的方法。然后，我们将通过使用SQLite分析一些GAPP数据来了解SQL的基本知识。

&emsp;&emsp;最后，在第14章中，我将讨论下一步如何进一步发展您的生物信息学技能。

## 代码约定

&emsp;&emsp;大部分生物信息学数据都有一个共同的特点：数据大。在代码例子中，我经常需要截断输出以使其适合页面的宽度。为了指示输出已被截断，我将在输出中始终使用[...]。另外，在代码示例中，我经常使用短的变量名来节省空间。我鼓励你们在个人工作中使用具有更多的描述性的名称来命名变量。

## 本书的约定

&emsp;&emsp;本书采用下面的排版约定：

*斜体*

&emsp;&emsp;指示新术语、URL、电子邮件地址、文件名和文件扩展名。

*恒定宽度*

&emsp;&emsp;用于程序清单，以及在段落中引用程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

*恒定宽度粗体*

&emsp;&emsp;显示用户应按字面输入的命令或其他文本。

*恒定宽度斜体*

&emsp;&emsp;显示应替换为用户提供的值或由上下文确定的值的文本。

!['suggestion'](../img/suggestion.png)这个元素表示提示或建议。

!['note'](../img/note.png)此元素表示一般注释。

!['warning'](../img/warning.png)此元素表示警告或警示。


## 代码使用示例

&emsp;&emsp;这本书可以在工作中帮到你。
## 在线资源

## 如何联系我们

&emsp;&emsp;如果有关此书的评论和问题请使用下面的联系方式向出版商提出：

O’Reilly Media, Inc.

1005 Gravenstein Highway North

Sebastopol, CA 95472

800-998-9938 (in the United States or Canada)

707-829-0515 (international or local)

707-829-0104 (fax)
## 确认

&emsp;&emsp;写一本书是一项巨大的工程，两年来，我在晚上和周末的时间都用在编写《生物信息学数据技能》这本书。生物信息学专业(在过去五个月的写作，作为一名博士生)是一个要求很高的职业。对大多数科学家来说，平衡工作和生活已经够困难的了；我现在知道，平衡工作、生活和写一本书几乎是不可能的。如果没有我的搭档海琳·霍普弗的支持，我是不会在这个过程中幸存下来的。