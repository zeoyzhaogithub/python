# 生物信息学数据技能


![生物信息学数据技能](../img/bioData.png '生物信息学数据技能')


使用开源工具进行可重复且可靠的研究

文斯布法罗


## 生物信息学数据技能

&emsp;&emsp;学习将大型测序数据集转化为可重复且稳健的生物学发现所需的数据技能。为了这个现实的目标，你应该学习如何使用免费开源的工具从大型且复杂的生物数据集中提取有意义的内容。

<!--TOC-->
- [生物信息学数据技能](#生物信息学数据技能)
    - [生物信息学数据技能](#生物信息学数据技能-1)
    - [绪论](#绪论)
        - [使用这本书的方法](#使用这本书的方法)
        - [为什么这本书关注测序数据](#为什么这本书关注测序数据)
        - [观众](#观众)
        - [不同级别的数据技能](#不同级别的数据技能)   
        - [这本书的假设](#这本书的假设)    
        - [github上的补充资料](#github上的补充资料)   
        - [计算资源和设置](#计算资源和设置)   
        - [本书的构成](#本书的构成)    
        - [代码约定](#代码约定)  
        - [本书的约定](#本书的约定)   
        - [代码使用示例](#代码使用示例)   
        - [在线资源](#在线资源)   
        - [如何联系我们](#如何联系我们)  
        - [确认](#确认)
    - [第一部分 意识形态：强大且可重复的生物信息学的数据技能](#第一部分-意识形态强大且可重复的生物信息学的数据技能)    
        - [一、如何学习生物信息学](#一如何学习生物信息学)
    - [第二部分 先决条件：开始生物信息学项目的基本技能](#第二部分-先决条件开生物信息学项目的基本技能)    
        - [二、建立和开展生物信息学项目](#二建立和开展生物信息学项目)    
        - [三、补充Unix Shell知识](#三补充unix-shell知识)    
        - [四、使用远程机器](#四使用远程机器)    
        - [五、git科学家](#五git科学家)    
        - [六、生物信息学数据](#六生物信息学数据)
    - [第三部分 实践：生物信息学数据技能](#第三部分-实践生物信息学数据技能)   
        - [七、Unix 数据工具](#七unix-数据工具)    
        - [八、快速介绍r语言](#八快速介绍r语言)    
        - [九、使用范围数据](#九使用范围数据)    
        - [十、使用序列数据](#十使用序列数据)    
        - [十一、使用对齐数据](#十一使用对齐数据)    
        - [十二、生物信息学shell脚本，编写管道和并行化任务脚本](#十二生物信息shell脚本编写管道和并行化任务脚本)    
        - [十三、补充知识Tabix 和SQLite](#十三补充知识tabix-和sqlite)    
        - [十四、总结](#十四总结)    
        - [然后去哪？](#然后去哪)    
        - [术语表](#术语表)    
        - [参考书目](#参考书目)    
        - [索引](#索引)



# 绪论

&emsp;&emsp;在两年前对我自己提出的这个问题的回答。当我开始在这个领域工作时，我只有python和r方面的编程经验，其他方面的经验很少。我四处寻找关于生物信息学的极好的入门教材，虽然我找到了一些好书，但大多数都不是针对我作为生物信息学家的日常工作所需要的。我找到的一些文本从理论和算法的角度探讨了生物信息学，包括Smith-Waterman比对、系统发育重建、motif查找等主题。尽管它们很吸引人去阅读(并且我确实建议您多阅读这些材料)，但我没有必要在我的日常生物信息学工作中从头开始实现生物信息学算法——这些算法已经存在大量出色的、高度优化的、经过良好测试的实现。其他生物信息学文本采取了更为明确的方法，指导不熟悉计算的读者完成每一步任务，比如运行对齐器或从数据集中下载序列。虽然这些更适用于我的工作，但是，相对而言，他们的书中的大部分内容是过时的。

&emsp;&emsp;正如你所猜到的那样，我找不到比这版的《生物信息学数据技能》更好的生物信息学书了。这本书面向那些不确定如何弥合脚本语言和实践生物信息学之间的巨大差距以便以一个健壮的和可复用的方式回答科学问题的读者。要弥合这一差距，必须学习数据技能 - 这种方法使用一套核心工具来操纵和探索您在生物信息学项目中遇到的任何数据。

&emsp;&emsp;数据技能是学习生物信息学的最佳方法，因为这些技能使用经过时间检验的开放源码工具，这些工具仍然是操作和探索不断变化的数据的最佳方法。这种方法经受住了时间的考验:高通量测序的出现迅速改变了生物信息学领域，但熟练的生物信息学使用这些相同的工具和技能来适应了这一新数据。毕竟，下一代数据只是数据（差异数据，以及更多数据），而生物信息学大师拥有通过将他们的工具应用于这些新数据来解决问题的基本技能。编写《生物信息学数据技能》是为了帮您学习这些核心工具，帮助您发展相同的技能。

## 使用这本书的方法
&emsp;&emsp;许多生物学家从生物信息学起步，往往把“学习生物信息学”等同于“学习如何运行生物信息学软件”。
## 为什么这本书关注测序数据

&emsp;&emsp;生物信息学是一门广泛的学科，涵盖蛋白质组学，代谢组学，结构生物信息学，比较基因学，机器学习和图像处理等子领域。本书主要关注处理测序数据，原因有几个。

&emsp;&emsp;首先，测序数据资源丰富。目前，没有其他“组学”能像测序数据一样有高通量且丰富的数据。测序数据在生物学中具有广泛的应用：变异检测和基因分类，用于基因表达研究的转录组测序，蛋白质-DNA相互作用测定如ChIP-seq，以及用于亚硫酸氢盐甲基化研究的测序等几个例子。这种用测序数据来回答生物学问题的方式只会越来越多。

&emsp;&emsp;其次，测序数据非常适合磨炼你的数据技能。即使，在将来你准备分析其他类型的数据，测序数据依然是学习的最佳示例数据。开发使用测序数据所必需的文本处理技能将适用于处理许多其他数据类型。

&emsp;&emsp;然后，生物信息学的其他子领域更具特定领域。测序的广泛可用性和不断下降的成本使得所有学科的科学家能够使用基因组学数据来回答他们系统中的问题。相比之下，像蛋白质组学或高通量图像处理这样的生物信息学子学科更加专业化，而且不那么广泛。但是，如果您对这些领域感兴趣，本书将教您有用的计算和数据技能，这将有助于您的研究。

## 观众

&emsp;&emsp;根据我在加州大学戴维斯分校为我的朋友、同事和学生进行为期一周的密集课程生物信息学的教学经验，大多数希望学习生物信息学的人都是生物学家或计算机科学家/程序员。生物学家希望教授他们分析自己的数据所必需的计算技能，而程序员和计算机科学家希望教他们如何利用计算技能去解决生物学问题。尽管这两组在生物学知识和计算经验方面存在很大差异，但是《生物信息学数据技能》这本书覆盖的内容对于这两组的诉求都能给与帮助。

&emsp;&emsp;如果你是生物信息学家，《生物信息学数据技能》这本书将会教你在工作中需要的处理生物信息数据的核心技能。值得注意的是，这本书不是一本告诉你什么是生物信息学的书籍;这本关于生物信息学的书很快就会出现数据，或者过于专注于数据以至于无法帮助大多数生物学家。您需要根据您的特定研究方向和系统需求，以及您的子领域使用的现代统计和生物信息学方法，补充本书没有的内容。例如，如果您的项目涉及将测序读数与参考基因组对齐，本书将不会告诉您最新且最佳的校准软件适用于您的特定系统。但无论您使用哪种校准器，您都需要了解校准格式和如何操纵对齐数据 - 这些内容在第11章中有相关介绍。

&emsp;&emsp;在本书中，这些一般的计算和数据技能是大多数生物学家可以构建的坚实，广泛适用的基础。如果你是一个计算机科学家或者程序员，我在这本书中讲到的算法工具你肯定很熟悉。虽然本书中介绍的内容可能与您已有的知识重叠，但您仍将了解生物信息学家在工作中使用的具体格式，工具和方法。同时，通过本书中的示例，您将获得应用基因组学数据的计算技巧。

## 不同级别的数据技能

&emsp;&emsp;这本书旨在成为一本紧密相宜的书。当我开始写这本书的时候，我决定我能做的最坏的打算就是把生物信息学当做一门比实际情况更容易的学科。作为一个专业的生物信息学家，我经常看到一些非常微妙的问题会突然出现，如果他们没有被发现，就会对分析结果产生不利的影响。我不希望你的生物信息学工作是不正确的，因为我人为地简化了一个主题。在《生物信息学数据技能》中的主题涉及的内容比较难，如果你能很好的理解这些内容，你在自己的工作中发现了类似的问题时，能够很好的利用这些知识解决问题。

&emsp;&emsp;这本书的章节内容比较超前，对于部分读者来说可能比较难。不要气馁！像大多数学科一样，这种学科很难，所以，可能需要多读几次才能完全理解。在整本书中，我试图表明。当某些部分特别难时，您可以跳过这些部分之后返回到这些部分进行学习。

&emsp;&emsp;最后，我经常在整本书中使用技术术语。我不喜欢使用技术术语，但在计算机领域，必须使用技术概念进行交流。而且，这种技术术语，可以帮助您可以搜索其他资源和帮助。例如，在google上搜索“左外部连接”比“在一个表中包含空记录的数据合并”要更容易得想要的结果。

## 学习前提

&emsp;&emsp;《生物信息学数据技能》是一本关于生物信息学的中间书籍。为了确保每个人都从同一个节奏开始，这本书从几个简单的章节开始。在第二章中设置了一些基础的生物信息学小项目，在第3章中，我将教授一些关于Unix基础内容，这些内容旨在确保您对Unix有一个基本的理解(因为在后面的章节中，Unix是一个很大章节去讲)。不过，作为一本中间的书，我对你做了一些假设：

*你会一门脚本语言*

&emsp;&emsp;这是使用这本书的前提。除了几个Python程序和R相关的内容(R在第8章中介绍)，这本书并不直接依赖于使用大量脚本。但是，在学习脚本语言时，您已经遇到了许多重要的计算概念，例如使用文本编辑器、在命令行上运行和执行程序以及基础的编程技能。如果你不会任何脚本语言，我建议你在学习这本书的同时学习python。例如《使用Python进行生物信息学编程》(Mitchell L. Model O‘Reilly，2009年)，《学习Python》，第5版(Mark Lutz O‘Reilly，2013年)，和 Python in a Nutshell，第二版(Alex Martelli O‘Reilly，2006)都是很好的开始学习Python的书。如果您知道除Python外的其他脚本语言(例如Perl或Ruby)，您将准备好跟随大多数示例(尽管您需要将一些示例转换成您熟悉的脚本语言)。

*你会使用文本编辑器*

&emsp;&emsp;了解文本编辑器(例如Emacs、Vim、Text-Mate2或SublimText)是很重要的。使用字处理器(例如Microsoft Word)将不起作用，我不鼓励使用记事本或OS X的Tex-tEdit等文本编辑器，因为它们缺乏对常见编程语言的语法突出显示的支持。

*你会Unix命令行*

&emsp;&emsp;例如，我假设您知道终端和shell之间的区别，了解如何输入命令,哪些命令行有什么选项，标志和参数，以及如何使用向上箭头检索最后输入的命令。您还应该对unix文件层次结构有一个基本的了解(包括主目录、相对目录与绝对目录以及根目录等概念)。您还应该能够使用cd、ls、pwd、mv、rm、rmdir和mkdir等命令在Unix中移动和操作目录和文件。最后，您应该掌握基本的Unix文件的所有权和权限，并使用chown和chmod更改它们。如果这些概念不清楚，我建议您小心使用unix命令行，并参考一本好的初学者级别的书，如《生物学家实用计算》( Steven Haddock and Casey Dunn Sinauer，2010年)或《UNIX和Perl基础》（UNIX and Perl to the Rescue）(Keith Bradnam and Ian Korf  剑桥大学出版社，2012年)。

*你对生物学有基本的了解。*

&emsp;&emsp;《生物信息学数据技能》需要你自己了解生物学的基础知识。除了DNA、RNA、蛋白质和基因之外，这些例子并不需要太多的生物学背景，也不需要分子生物学的核心内容。您还应该熟悉一些非常基本的遗传学和基因组概念(例如，单核苷酸多态性、基因型、GC内容等)。这本书中的所有生物学示例都设计得非常简单；如果您不熟悉某个专业名词，您应该能够快速浏览一篇Wikipedia相关的文章并继续该示例。

*您对正则表达式有基本的了解。*

&emsp;&emsp;偶尔，我会再这本书中使用正则表达式。大部分情况下，我将尝试使用最基本的正则表达式，以便您了解基本概念。如果您在学习脚本语言时遇到过正则表达式，那么就可以开始学习了。如果没有，我建议您学习基础的正则表达式知识-不是因为整本书中大量使用正则表达式，而是因为掌握正则表达式是生物信息学中的一项重要技能。《正则表达式介绍》作者迈克尔·菲茨杰拉德(Introducing Regular Expressions by Michael Fitzgerald O‘Reilly)是一本很好的书。现在，编写、测试和调试正则表达式比以往任何时候都更容易，这要归功于一些在线工具，如[https://jex.im/regulex/](https://jex.im/regulex/)、[http://regex101.com](http://regex101.com)和[http://www.debuggex.com](http://www.debuggex.com)我建议在您自己的工作中,使用这本书中的正则表达式示例时使用这些工具。

*你知道如何查找帮助并能看懂文档*

&emsp;&emsp;在这本书中，我尽量减少可以在手册、帮助文档或在线资源中找到的教学信息。有三个原因：

1. 我想节省空间，专注于以展示你在其他地方找不到的资料和内容。
2. 手册页和文档将永远是这方面信息的最佳资源。
3. 在文档中快速找到答案是你学习计算机最重要的技能之一。

&emsp;&emsp;最后这一点特别重要；您不需要记住所有命令或R函数的所有参数-您只需要知道在哪里可以找到这些信息。程序员在工作中经常参考文档，这就是为什么在文档存在诸如man(在Unix中)和help()(在R中)工具的原因。

*您可以管理你的计算机系统(或拥有系统管理员权限)*

&emsp;&emsp;本书并没有教您系统管理技巧，如设置生物信息学服务器或集群、管理用户帐户、网络安全、管理磁盘和磁盘空间、RAID配置、数据备份和高性能计算概念。根本没有足够的空间来充分讨论这些重要的话题。然而，这些都是非常，非常重要的，如果您没有系统管理员，并且需要为您的实验室或研究团队填补该职位，则您也必须掌握这些技能。坦率地说，系统管理技能需要几年的时间才能掌握，而优秀的系统管理员在处理问题时具有令人难以置信的耐心和经验，这些问题会使大多数科学家发疯。如果您可以使用在实验室或组之间共享的全职系统管理员，或者使用带有系统管理员的大学群集，我就是这样做的。最后，这不是必须的，只是以防万一：不断备份你的数据和工作结果。当学习Unix来执行一个破坏文件的命令是很容易的-你最好的防止丢失所有东西的方法就是连续备份。

## github上的补充资料

&emsp;&emsp;这本书中的例子和其他资料可以在[github](https://github.com/vsbuffalo/bds-files)上获取。您可以根据需要从git库下载相应内容(git上的内容按章分类)，或者，您可以通过链接下载Zip文件包。一旦您在第5章中学习了Git，我将建议您克隆存储库，以便在意外重写任何示例文件时都可以恢复它们。等到在第5章中学习了Git，我将建议您克隆存储库，以便在意外重写任何示例文件时都可以恢复它们。现在尝试导航到这个存储库并浏览相应内容，以便熟悉正本书的布局。查看前言的目录，您会发现README.md文件，其中包含关于我所讨论的许多主题的其他信息。除了本书中所有示例所需的补充文件外，此存储库还包含：
1. 关于所有补充文件是如何制作或如何获得的文件。在某些情况下，我通过创建文件或脚本(这两个主题都包含在第12章中)来创建示例数据，所有这些资源都可以在每章的GitHub目录中找到。包括了这些材料，不仅是为了可以重复使用，而且也是作为额外的学习材料。
2. 读者可能会对每一章都感兴趣。这些信息在每章的README.md文件中有列出。我还包括了其他资源，如推荐以供进一步学习的书籍列表，。
3. 纠错，以及任何必要的更新(如料由于某种原因而过时)。

&emsp;&emsp;我选择在GitHub上托管《生物信息学数据技能》的补充文件，这样我可以随时更新所有内容，并解决读者可能遇到的任何问题。如果您发现这本书或它的补充材料有任何问题，请随时在GitHub上创建一个新的问题。

## 计算资源和设置

&emsp;&emsp;我是在一台15英寸16 GB的RAM的MacBookPro笔记本电脑上完成整本书的写作。尽管这是一台功能强大的笔记本电脑，但它比生物信息学计算中常见的服务器要小得多。所有的例子都被设计和测试来运行一台这么大的机器。几乎每个示例都应该在具有8 GB内存的计算机上运行。

&emsp;&emsp;本书中的所有示例都不支持MacOSX和Linux以外的其他操作系统(主要是因为现代生物信息学依赖于基于Unix的操作系统)。本书中所需的所有软件都是免费提供的，并且易于安装；因为需要安装软件，所以我在每一节中都提供了一些基本的说明。通常，您应该使用操作系统的包管理系统(例如，在Ubuntu/Debian上的APT-GET)。如果您使用的是Mac，我强烈推荐Homebrew，这是一个非常棒的OSX软件包管理器，您可以使用它用命令行轻松地安装软件。你可以在Homebrew的官网上找到详细的说明，最重要的是Homebrew维护一组名为“Homebrew-Science”的科学软件包，包括我们在本书中使用的生物信息学软件。按照Homebrew-Science‘s的Readme.md文件中的说明学习如何安装这些科学程序。

## 本书的构成

&emsp;&emsp;这本书由三部分构成：第一部分，包含一个关于意识形态的章节；第二部分，包括生物信息学项目入门的基础知识；第三部分，涉及生物信息学数据技能。虽然章节是按顺序编写的，但如果您熟悉Unix和R，您可能会发现您可以跳过这些章节而不会遇到任何问题。

&emsp;&emsp;在第一章中，我介绍了为什么通过发展数据技能来学习生物信息学是最好的方法。我还介绍了这本书的思想，并描述了可再生和强大的生物信息学和一些建议，以适用于您自己的工作。

&emsp;&emsp;《生物信息学数据技能》第二部分介绍了启动生物信息学项目所需的基本技能。首先，我们将在第2章中研究如何设置和管理项目目录。这可能看起来是个琐碎的话题，但复杂的生物信息学项目需要我们考虑项目管理。在大型的研究中，到处都是文件。从一个精心组织的项目开始，可以避免许多不必要的麻烦。我们还将学习一种非常有用的纯文本项目文档格式Markdown文档。

&emsp;&emsp;在第三章中，为了确保您对基本概念(例如，管道、重定向、标准输入和输出等)有扎实的理解，我们将会讲解生物信息学中的UNIX。了解这些必备的基础知识将使您能够在后面的章节中专注于分析数据，而不是费尽周折地理解Unix的基础知识。

&emsp;&emsp;大多数生物信息学任务需要更强的计算能力，这意味着我们必须使用远程服务器和集群。第4章介绍了在使用远程机器时提高工作效率的一些方法和技巧。

&emsp;&emsp;在第五章中我们将学习一个简化项目版本管理的版本控制系统-git。生物信息学项目充满了大量的代码和数据，这些代码和数据应该使用与协作开发的软件相同的现代工具进行管理。Git是一款功能强大的大型软件，因此这是一个很长的章节。但是，编写本章是为了使您可以跳过关于分支的一节，稍后再返回到它。

&emsp;&emsp;第6章研究生物信息学项目中的数据：如何下载大量数据、如何使用数据压缩、验证数据完整性以及如何可重复地下载项目数据。

&emsp;&emsp;在第三部分中，我们的注意力转向发展所有生物信息工作者在日常工作中解决问题所需的基本数据技能。第7章重点介绍Unix数据工具，这些工具允许您快速编写强大的流处理Unix管道来处理生物信息学数据。这种方法是现代生物信息学的基石，是一项绝对必要的数据技能。

&emsp;&emsp;在第八章中，我通过学习探索性数据分析技术来介绍R语言。本章让您使用R来使用可视化和数据汇总等技术来探索您自己的数据。

&emsp;&emsp;基因组范围数据在生物信息学中是无处不在的，因此我们将在第9章中讨论范围数据和范围操作。我们将首先通过不同的方法来表示基因组范围，并通过使用BioConductor的IRrangesPackage包进行范围操作来增强我们的范围思维直觉。然后，我们将使用GenomicRange处理基因组数据。最后，我们将研究用于在命令行上处理范围数据的BED工具包。

&emsp;&emsp;在第10章中，我们学习了序列数据，它是生物信息学数据的支柱。我们将研究Fasta和FASTQ格式(以及它们的局限性)，并通过从序列中修剪低质量的基组，看看这是如何影响质量分数的分布的。我们还将研究Fasta和FASTQ的解析。

&emsp;&emsp;第11章重点介绍了对准数据格式SAM和BAM。理解和操作这些格式的文件是处理高通量测序数据的一项不可或缺的生物信息学技能。我们将学习如何使用Samtools操作这些文件并对这些数据进行可视化处理，通过一个详细的示例来说明变量调用的一些复杂性。最后，我们将学习如何使用Pysam来解析SAM/BAM文件，以便您可以编写自己的脚本来处理这些特定数据格式的文件。

&emsp;&emsp;大多数生物信息学的日常工作都涉及到编写数据处理脚本和管道。在第12章中，我们将介绍如何编写健壮的和可复用的数据处理管道。我们将专门研究Bash脚本，使用Unix强大工具(如find和xargs)处理文件，最后快速了解如何使用make和makefile编写管道。

&emsp;&emsp;在生物信息学中，我们的数据常常太大，无法放入我们的计算机内存中。在第7章中，我们了解了如何使用Unix管道流处理来帮助解决这个问题，但是第13章介绍了一种不同的方法：不适用内存的方法。首先，我们将研究Tabix，这是一种快速访问索引制表符分隔文件中的信息的方法。然后，我们将通过使用SQLite分析一些GAPP数据来了解SQL的基本知识。

&emsp;&emsp;最后，在第14章中，我将讨论下一步如何进一步发展您的生物信息学技能。

## 代码约定

&emsp;&emsp;大部分生物信息学数据都有一个共同的特点：数据大。在代码例子中，我经常需要截断输出以使其适合页面的宽度。为了指示输出已被截断，我将在输出中始终使用[...]。另外，在代码示例中，我经常使用短的变量名来节省空间。我鼓励你们在个人工作中使用具有更多的描述性的名称来命名变量。

## 本书的约定

&emsp;&emsp;本书采用下面的排版约定：

*斜体*

&emsp;&emsp;指示新术语、URL、电子邮件地址、文件名和文件扩展名。

*恒定宽度*

&emsp;&emsp;用于程序清单，以及在段落中引用程序元素，如变量或函数名、数据库、数据类型、环境变量、语句和关键字。

*恒定宽度粗体*

&emsp;&emsp;显示用户应按字面输入的命令或其他文本。

*恒定宽度斜体*

&emsp;&emsp;显示应替换为用户提供的值或由上下文确定的值的文本。

## 代码使用示例

&emsp;&emsp;这本书可以在工作中帮到你。
## 在线资源

## 如何联系我们

&emsp;&emsp;如果有关此书的评论和问题请使用下面的联系方式向出版商提出：

O’Reilly Media, Inc.

1005 Gravenstein Highway North

Sebastopol, CA 95472

800-998-9938 (in the United States or Canada)

707-829-0515 (international or local)

707-829-0104 (fax)
## 确认

&emsp;&emsp;写一本书是一项巨大的工程，两年来，我在晚上和周末的时间都用在编写《生物信息学数据技能》这本书。生物信息学专业(在过去五个月的写作，作为一名博士生)是一个要求很高的职业。对大多数科学家来说，平衡工作和生活已经够困难的了；我现在知道，平衡工作、生活和写一本书几乎是不可能的。如果没有我的搭档海琳·霍普弗的支持，我是不会在这个过程中幸存下来的。

# 第一部分 意识形态：强大且可重复的生物信息学的数据技能

## 第一章、如何学习生物信息学

&emsp;&emsp;现在，在世界各地的实验室里，机器正在对地球上生命的基因进行测序。即使成本迅速下降，基因组测序技术也有例如巨大进步，我们也只能看到每个细胞、组织、有机体和生态系统中包含的生物信息的一小部分。然而，我们正在收集的全部生物信息中的一小部分相当于生物学家需要处理的大量数据。在人类历史上，我们对生活复杂性的理解能力从未像现在这样如此依赖于我们处理和分析数据的技能。

&emsp;&emsp;这本书是关于通过发展数据技能来学习生物信息学的。在本章中，我们将了解什么是数据技能，以及为什么学习数据技能是学习生物信息学的最佳方法。我们还将研究什么是可靠和可重复的研究。

### 为什么是生物信息学？生物学生长数据

&emsp;&emsp;生物信息学家关注的是用专门的技能工具分析大量的数据中获取对生物的理解。在生物学的早期历史中，这些数据集很小且易于管理。大多数生物信息学家，在学习过统计的课程之后，都可以在自己的电脑上利用微软的Excel分析他们的生物信息数据。然而，这一切都在迅速被改变。大规模的测序数据开始应用，而且在未来的应用汇更加广泛。分析这些数据需要不同的工具、新的技能和许多具有大量内存、处理能力和磁盘空间的计算机。

&emsp;&emsp;在短期内由于测序成本大幅下降，使研究人员能够利用测序数据帮助回答重要的生物学问题。早期测序比较苦难而且成本很高。全基因组测序工作代价高昂(人类基因组的测序成本约为27亿美元)，而且只有通过大规模的合作努力才有可能实现。自人类基因组发布以来，测序成本从2008年开始一直呈指数下降，具体如图1-1所示。随着下一代测序技术的引入，DNA测序的成本下降得更快。在这个关键时刻，以前只有大型合作测序机构(或财力非常雄厚的个人研究人员)才能负担得起的技术，现在对于所有生物学领域的研究人员来说都能负担得起了。阅读这本书很可能是为了学习如何处理测序数据，而这些数据在10年产生的成本会非常昂贵。

![图1-1](../img/1-1.png)

图1-1、2008年前后排序成本的下降是由于引入了下一代测序数据（图转载，数据从国家卫生研究院下载[NIH](https://www.genome.gov/about-genomics/fact-sheets/Sequencing-Human-Genome-cost))

&emsp;&emsp;这些使测序成本下降的新技术将会导致什么后果呢？正如你所猜到的那样，数据越来越多。随着数据越来越多，生物数据库也经历了指数增长。过去，协作者之间共享小型数据库就足够了，而现在全世界的服务器上都有千兆字节的有用数据。生物学问题的关键数据不仅存在于硬盘上未经分析的实验数据中，而且还存储在数千英里之外的数据中心的磁盘上。

&emsp;&emsp;生物数据库的增长就像测序成本的下降一样令人震惊。例如，考虑[序列读取存档](https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?)(以前称为短文档)。自2010年以来，它经历了显著的增长(见图1-2)。

![图1-2](../img/1-2.png)

图1-2、短读档案馆呈指数增长；开放存取库是向公众提供SRA提交的材料(附图和从[NIH](https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?)下载的数据)

&emsp;&emsp;要将测序数据的这种难以置信的增长放在上下文中，请考虑摩尔定律。

&emsp;&emsp;使事情变得更加复杂的是，分析生物数据的新工具不断被创造出来，它们的基本算法也在不断进步。

&emsp;&emsp;不幸的是，生物信息学工具的这种丰富和快速的发展有严重的不利之处。

### 为学习生物信息学而学习数据技能

&emsp;&emsp;必须

# 第二部分 先决条件：开始生物信息学项目的基本技能
## 二、建立和开展生物信息学项目
## 三、补充Unix Shell知识
## 四、使用远程机器
## 五、git科学家
## 六、生物信息学数据
# 第三部分 实践：生物信息学数据技能
## 七、Unix 数据工具
## 八、快速介绍r语言
## 九、使用范围数据
## 十、使用序列数据
## 十一、使用对齐数据
## 十二、生物信息学shell脚本，编写管道和并行化任务脚本
## 十三、补充知识Tabix 和SQLite
## 十四、总结

&emsp;&emsp;当我打算开始写《生物信息学数据技能》时，起初，我为如何以一种不会在快速发展的生物信息学领域迅速过时的方式，以书的形式呈现中等水平的生物信息学而苦苦挣扎。甚至在我完成这本书的时间里，新的闪亮算法、统计方法和生物信息学软件已经被生物信息学社区发布和采用。有可能(甚至可能)新的测序技术将再次给生物学带来革命性的变化，而生物信息学将需要调整它们的方法和工具。在这个不断变化的环境中，纸质书如何成为一项有价值的学习资产?

&emsp;&emsp;我通过每天在工作中使用的工具-Unix，Python和R-找到了这个问题的答案。Unix的时间可以追溯到20世界70年代，它已经有40多年的历史了。Python诞生于1991年，R出现于1993年，他们都有超过20年的历史了。这些工具都经受住了时间的考验，并且是现代数据处理和统计计算的基础。生物信息学和Unix有着几乎不可分割的历史——学习生物信息学技能首先需要学习的是Unix。在基因组学快速发展的同时，生物信息学家继续寻求同样的标准工具来解决新问题和分析新数据集。此外,Unix，Python和R都是可扩展的工具。几乎所有新的生物信息学程序都可以用于Unix命令行。工作期间，使用最新的生物信息学和统计学方法归根结底都是下载和安装新的Python和R包。这本书中庸到的其他工具-GenomicRanges，sqlite3、sam-都是在Unix，Python和R运行的数据工具包。此外，为了能在我们日常工作中充分利用这些工具的价值，我们可以将这些工具组合在一起- 搭建基础生物信息学计算环境进行使用。虽然我们无法确定未来的测序技术将允许我们做什么，但我们可以确信unix，python和r将继续成为现代生物信息学的基础。

&emsp;&emsp;然而，单靠强大的工具并不能创造出一个熟练的生物信息学家。使用强大的工具来熟练地解决实际问题需要一套先进的技能。对于生物信息学，只有在工作中，运用真实数据结合这些技能进行使用才能真正发挥这些技能的价值。《生物信息学数据技能》这本书侧重于一种强大且可重复的方法，因为这是开发生物信息学技能的最佳环境。对某个工具和数据的不信任以及对分析过程中可能发生的众多陷阱的认识是最重要的技能之一。但是，当你遇到并且对自己研究中遇到的严重问题进行解决时，你才会充分理解并掌握这些技能。

## 接下来你将会去哪呢？

&emsp;&emsp;本书是为熟悉脚本和一些unix，但对于不知道如何将这些技能解决日常生物信息学问题的读者设计的。在整本书中，我们已经看到了许多其他工具，并且学到了重要的技巧来解决生物信息学中的几乎所有问题（以及对齐器，装配器等运行工具）。接下来你将会去哪呢？

&emsp;&emsp;首先，我建议你学习更多的统计和概率的内容。这是最为重要的一点。通过学习这本书中的内容，并结合真实数据进行运用，要想成为一个高超的生物信息学家，接下来你需要学习统计和概率的内容。实践技能主要是计算;将基因组学数据过多转化为有意义的生物学知识，关键取决于你使用统计学的能力。同样，理解概率论并具备将其应用于生物学问题的技能，可以为您提供一种全新的方法来解决问题。甚至在你自己的工作中应用简单的概率方法可以让你摆脱不愉快的启发式方法，并且通常可以更好地工作。此外，许多新的创新生物信息学方法建立在概率模型上 - 熟悉基础的概率力学内容对于理解这些方法的工作原理以及它们可能在哪些条件下不能使用至关重要。

&emsp;&emsp;其次，我建议学习计算机科学的一些基础 - 尤其是算法和数据结构。我们需要在生物信息学中处理大量数据，而且如果不熟悉数据结构，肯容易采用一种计算效率低下的方法。研究人员往往需要更多的算力来并行运行代码，如果代码更高效，这些代码可以很容易地在本地计算机上运行。幸运的是，只需要对算法和数据结构有一些基本的了解就可以设计出高效的软件和脚本。我还建议学习对齐器和汇编器中使用的专业生物信息学算法;深入了解这些算法可以帮助您了解生物信息学软件的局限性并选择恰当的软件（如果您愿意，可以提高自己的技能！）
 
&emsp;&emsp;有关这些主题的更多方向，请参阅本章的github上的自述文件。我在这部分包含了自己最喜欢的书，并且还添加了一些我发现的其他书籍。最后，在你成为一个专业的生物信息学家的路途上，我能给你的最后一个建议是使用现有资源。换句话说，阅读代码，阅读大量的代码-（尤其是那些比你技术娴熟的程序员的代码）。开发编程经验技能90％是关于编写，调试和多年的代码爬坑。但是在这个过程中阅读和学习他人的代码就像是一个秘密的捷径。虽然最初盯着数百行代码看起来令人望而生畏。在成千上万行别人的复杂代码中，你同时通过学习比你更聪明程序员的技巧来强化你快速理解代码的能力。在时间之外，阅读别人代码的练习将奖励你更好的程序技能。

## 术语表

## 参考书目

## 索引